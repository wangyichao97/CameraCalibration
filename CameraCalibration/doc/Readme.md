# 采用PnP算法实现棋盘格相机标定

## 实验要求

靶标距离相机初始位置2m，相机向靶标移动，最近处0.5m。实时拍照，定位靶标。使用相机：海康相机（2D定位）、3D结构光（待借）

靶标使用二维码或棋盘格或乒乓球，目标物使用标准量块。

## 实验思路

按照实验要求，从0.5m处开始每隔0.25m进行一次拍照取点，共取7张照片，相机镜头最初采用16mm镜头，经实验测量发现视野过小，难以完整显示标靶，改用8mm镜头，焦点为0.75-1m之间，光圈为f/4，曝光时间为自适应时间。

靶标最初选取乒乓球，但由于光线和镜头焦距问题，难以完成全距离范围内的靶标识别，于是改用棋盘格作为靶标，棋盘格为正方形，尺寸为15mm。

此外还拍摄了17张照片用于相机内参标定。

## 算法实现思路



我认为相机标定需要知道相机与图像之间四个坐标系之间的关系，分别求取这四个坐标并出世界坐标系与相机坐标系之间的位姿变化。

其中：

1. 需要知道n个世界坐标系下参考点的3D坐标系。为此，每张照片都选取棋盘格左上角为世界坐标系原点。
2. 需要知道这个n个3D坐标对应相机图像坐标系上的2D投影点，为此采用findChessboardCorners函数找寻角点，并采用cornerSubPix函数进行亚像素精确化
3. 需要知道相机摄像头的内参，因此选用calibrateCamera函数求取相机的内参矩阵和畸变系数
4. 需要求取求世界坐标系与摄像机坐标系之间的位姿变换，即R:旋转矩阵和t：平移矩阵，为此采用solvePnP求每张图片的位姿变换。

## 实验结果分析

0.5-2m处分别拍摄照片，1.25m后照片失焦，其中失焦最严重为2m，这对标定结果会存在较大影响，因此实验过程中需要注意对焦问题。

​    检测实际测量数据与检测数据的偏差，随着距离的增加拉大，标定误差逐渐增大，误差的原因主要来源于相机失焦，小部分原因来源于相机与靶标测量距离存在误差，以及靶标z轴不是严格为0。



## 总结



​    本次使用棋盘格对目标姿态进行估计，提取Z方向的坐标用于验证估计的准确性。实验测试目的主要在于求解出的XY方向偏差，应用于搭载相机的物体的定位。但由于XY方向的偏差在现有实验条件下无法测量，因此使用Z方向的误差，来初步判断XY方向的准确性。实验结论如下：

1. 实验过程应该严格调整对焦点，避免失焦影响标定误差。
2. 打光效果会影响成像效果，进而影响靶标识别效果。
